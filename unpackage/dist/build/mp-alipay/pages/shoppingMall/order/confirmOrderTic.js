(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/shoppingMall/order/confirmOrderTic"],{"2a59":function(t,e,a){"use strict";a.r(e);var n=a("9ddf"),r=a("4856");for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("39d6");var i,u=a("f0c5"),c=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);e["default"]=c.exports},"39d6":function(t,e,a){"use strict";var n=a("6b89"),r=a.n(n);r.a},4856:function(t,e,a){"use strict";a.r(e);var n=a("bfe7"),r=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},"6b52":function(t,e,a){"use strict";(function(t){a("d977");n(a("66fd"));var e=n(a("2a59"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("c11b")["createPage"])},"6b89":function(t,e,a){},"9ddf":function(t,e,a){"use strict";var n={uniNavBar:function(){return a.e("components/uni-nav-bar/uni-nav-bar").then(a.bind(null,"44c0"))},aNodeData:function(){return a.e("components/a-nodeData/a-nodeData").then(a.bind(null,"f6d5"))},aGoodLineBox:function(){return Promise.all([a.e("common/vendor"),a.e("components/a-good-lineBox/a-good-lineBox")]).then(a.bind(null,"a0c4"))},uniPopup:function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"a329"))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,a("0697")),r=Number(t.CardInfo.Balance),o=a("8703");t.$mp.data=Object.assign({},{$root:{m0:n,m1:r,m2:o}})},o=[];a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}))},bfe7:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(a("4795")),r=a("57bb"),o=a("657b"),i=u(a("c1d6"));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e,a,n,r,o,i){try{var u=t[o](i),c=u.value}catch(s){return void a(s)}u.done?e(c):Promise.resolve(c).then(n,r)}function s(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var o=t.apply(e,a);function i(t){c(o,n,r,i,u,"next",t)}function u(t){c(o,n,r,i,u,"throw",t)}i(void 0)}))}}var d=function(){a.e("node-modules/adcell/ADCell").then(function(){return resolve(a("1420"))}.bind(null,a)).catch(a.oe)},l={name:"confirmOrder",components:{adCell:d},data:function(){return{isDisabled:!1,mainStyle:getApp().globalData.mainStyle,mainColor:getApp().globalData.mainColor,loading:!0,currentItem:[],radioModes:2,prodList:[],totalCurrent:0,radioPayType:"1",CardInfo:{},cardSids:[],testData:{},allData:{},SumTotal:"",ScoreAmt:"",password:"",IsPass:"",payTypePop:!1}},created:function(){var t=this;return s(n.default.mark((function e(){var a;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.state.currentCard&&0!==t.$store.state.currentCard.length||(t.$Router.back(2),t.$Router.back(100)),a=t.$store.state.currentCard||[],t.currentItem=a,t.cardSids=t.cardSids?t.cardSids.join(","):"",e.next=6,t.getInfo();case 6:case"end":return e.stop()}}),e)})))()},methods:{getInfo:function(){var t=this;return s(n.default.mark((function e(){var a,o,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,a=JSON.parse(localStorage.getItem("currentStoreInfo")),o=JSON.parse(localStorage.getItem("currentCard")),e.prev=3,e.next=6,(0,r.vipCard)({Action:"TicketBuy",ShopSID:a?a.data.SID:"",ProdList:t.currentItem,PromotionItemSID:o[0].PromotionItemSID},"UProdOpera");case 6:i=e.sent,t.prodList=i.Data.ProdList,t.SumTotal=i.Data.SumTotal,t.ScoreAmt=i.Data.ScoreAmt,t.CardInfo=i.Data.hasOwnProperty("CardInfo")?i.Data.CardInfo:{},"{}"!==JSON.stringify(t.CardInfo)?Number(i.Data.CardInfo.Balance)<Number(i.Data.SumTotal)&&(t.radioPayType="2"):t.radioPayType="2",e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](3),t.$toast(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})))()},PayTypeClick:function(t){this.CardInfo&&Number(this.CardInfo.Balance)<this.totalCurrent||(this.radioPayType=t)},radioPayChange:function(t){this.CardInfo&&Number(this.CardInfo.Balance)<this.totalCurrent||(this.radioPayType=t.detail.value)},getWxConfig:function(){var t=this;return s(n.default.mark((function e(){var a,o;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,r.vipCard)({Action:"GetJSSDK",Url:window.location.href},"UProdOpera");case 3:a=e.sent,o=a.Data,i.default.config({debug:!1,appId:o.SDK.appId,timestamp:o.SDK.timestamp,nonceStr:o.SDK.noncestr,signature:o.SDK.signature,jsApiList:["getLocation","openAddress","scanQRCode"]}),i.default.ready((function(e){var a=t;i.default.getLocation({type:"gcj02",success:function(t){a.location={longitude:t.longitude,latitude:t.latitude},a.$store.commit("SET_CURRENT_LOCATION",a.location),sessionStorage.setItem("location",JSON.stringify(a.location))},cancel:function(t){this.$toast.fail(t)}}),i.default.error((function(t){this.$toast.fail(t),console.log("调用微信接口获取当前位置失败",t)}))})),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})))()},clickLeft:function(){this.$Route.query.flag?this.$Router.push({path:"/pages/shoppingMall/menu_naixue/menu/menu",query:{flag:"Deflocation"}}):window.history.back(-1)},submitMoney:function(){"1"===this.radioPayType?(this.payTypePop=!0,this.$refs.payTypePop.open()):this.OrderCardPay()},OrderCardPay:function(){var e=this;return s(n.default.mark((function a(){var i,u,c,s;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.isDisabled=!0,setTimeout((function(){e.isDisabled=!1}),5e3),i=JSON.parse(localStorage.getItem("currentStoreInfo")),""!==e.password||"1"!==e.IsPass){a.next=6;break}return e.$toast("请填写密码"),a.abrupt("return");case 6:return u=JSON.parse(localStorage.getItem("currentCard")),a.prev=7,a.next=10,(0,r.vipCard)({Action:"TicketPay",ShopSID:i?i.data.SID:"",ProdList:e.currentItem,PayType:e.radioPayType,PromotionItemSID:u[0].PromotionItemSID},"UOrderOpera");case 10:if(c=a.sent,s=c.Data,"1"===e.radioPayType)e.$toast("订单正在处理中..."),setTimeout((function(){e.$Router.push({path:"/pages/vip/allMyOrder",query:{id:"0"}})}),3e3),e.payTypePop=!1,e.$refs.payTypePop.close();else{e.testData=s;try{(0,o.weChatPayment)(e,s,!1)}catch(n){that.$toast.fail(n),e.loading=!1,t.hideLoading()}}a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](7),e.$toast.error(a.t0);case 18:case"end":return a.stop()}}),a,null,[[7,15]])})))()}}};e.default=l}).call(this,a("c11b")["default"])}},[["6b52","common/runtime","common/vendor"]]]);