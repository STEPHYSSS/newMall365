(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/vip/bind/index"],{"446c":function(e,t,a){"use strict";var n=a("bc6a"),r=a.n(n);r.a},5921:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(a("4795")),r=a("657b"),i=a("57bb"),s=a("fff8"),o=u(a("b867"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,a,n,r,i,s){try{var o=e[i](s),u=o.value}catch(c){return void a(c)}o.done?t(u):Promise.resolve(u).then(n,r)}function d(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function s(e){c(i,n,r,s,o,"next",e)}function o(e){c(i,n,r,s,o,"throw",e)}s(void 0)}))}}var f={name:"bindMicro",components:{},data:function(){return{mainStyle:getApp().globalData.mainStyle,radio:"",loading:!1,fromData:{Phone:"",Type:"",Code:""},exhibitSex:"",Birthday:new Date,usernameTip:"",phoneTip:"",dayTip:"",sexTip:"",CodeTip:"",Password:"",minDate:new Date(1950,1,1),maxDate:new Date,isShow:!1,columns:[{text:"女",id:"1"},{text:"男",id:"2"}],getCodeNum:"获取验证码",CodeNum:60,disabledBtn:!1,bindListMe:s.bindList,bindCardList:[],CardNoId:"",showListCard:!1,fail:!1,IsPass:!1,btnLoading:!1,endData:"",Type:"",showCard:!1,showCardNo:!1,isActive:!1,isMember:o.default.get("isMember"),CardType:sessionStorage.getItem("cardType")}},created:function(){var e=this;return d(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"Manage"!==e.CardType&&"Shop"!==e.CardType||e.$Router.push("/pages/home"),1===e.isMember&&e.$Router.push("/pages/home"),e.endData=(0,r.getTime)("",!0),e.currentRouter?e.Type="1":(e.Type="0",e.getInfo());case 4:case"end":return t.stop()}}),t)})))()},computed:{currentRouter:function(){return"1"==this.$Route.query.id||!1}},methods:{getInfo:function(){var e=this;return d(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,(0,i.vipCard)({Action:"GetCardBase"},"WeChatCardOpera");case 4:a=t.sent,a.Data.CardBaseInfo&&a.Data.CardBaseInfo.ApplyMsg&&(r=a.Data.CardBaseInfo.ApplyMsg.split(","),r.forEach((function(t){e.$set(e.bindListMe[Number(t)],"isShow",!0)}))),e.IsPass=a.Data.CardBaseInfo.IsPass,e.loading=!1,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](0),e.loading=!1,e.fail=!0,e.$toast.fail(t.t0||"数据获取失败");case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},confirmEntityCard:function(){this.fromData.CardNo=this.CardNoId},beforeClose:function(e,t){var a=this;return d(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,Object.assign(a.fromData,{Action:"SetCard"}),e.next=4,(0,i.vipCard)(a.fromData,"WeChatCardOpera");case 4:a.$toast.success("绑定实体卡成功"),a.$Router.push("/home/index"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),a.$toast.fail(e.t0);case 11:t();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},clickSubmit:function(){var e=this;return d(n.default.mark((function t(){var a;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentRouter||(e.usernameTip=e.bindListMe[0].hasOwnProperty("isShow")?e.fromData.Username?"":"请输入名字":"",e.dayTip=e.bindListMe[1].hasOwnProperty("isShow")?e.fromData.Birthday?"":"请选择生日":"",e.sexTip=e.bindListMe[2].hasOwnProperty("isShow")?e.fromData.Sex?"":"请选择性别":"",e.Password="1"===e.IsPass?e.fromData.Password?"":"请填写密码":""),e.CodeTip=e.fromData.Code?"":"请填写验证码",h(e)){t.next=4;break}return t.abrupt("return");case 4:if(!e.CodeTip){t.next=8;break}return t.abrupt("return",!1);case 8:if(t.prev=8,!e.currentRouter){t.next=19;break}return e.fromData.Type=1,Object.assign(e.fromData,{Action:"SetCard"}),t.next=14,(0,i.vipCard)(e.fromData,"WeChatCardOpera");case 14:a=t.sent,o.default.set("isMember","1"),a.Success?(e.$toast.success("绑定实体卡成功"),setTimeout((function(){e.$Router.push("/pages/home")}),1e3)):e.$toast.success(a.Message),t.next=31;break;case 19:if(!(e.usernameTip||e.dayTip||e.sexTip||e.Password)){t.next=23;break}return t.abrupt("return",!1);case 23:return e.fromData.Type=0,Object.assign(e.fromData,{Action:"SetCard"}),t.next=27,(0,i.vipCard)(e.fromData,"WeChatCardOpera");case 27:o.default.set("isMember","1"),e.CodeNum=0,e.$toast.success("申请成功"),setTimeout((function(){e.$Router.push("/pages/home")}),1e3);case 31:t.next=37;break;case 33:t.prev=33,t.t0=t["catch"](8),e.$toast.fail(t.t0),e.CodeNum=0;case 37:case"end":return t.stop()}}),t,null,[[8,33]])})))()},confirmDate:function(e){this.$set(this.fromData,"Birthday",e.detail.value),this.dayTip=this.fromData.Birthday?"":"请选择生日"},onConfirm:function(e){this.exhibitSex=this.columns[e.detail.value].text,this.fromData.Sex=this.columns[e.detail.value].id,this.sexTip=this.fromData.Sex?"":"请选择性别"},getCodeFun:function(e){var t=this;return d(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!h(t)){a.next=11;break}return a.prev=1,a.next=4,(0,i.vipCard)({Action:"SendCode",Phone:t.fromData.Phone,Type:t.Type},"WeChatCardOpera");case 4:t.Timing(e),t.$toast.success("发送至您的手机，注意查收"),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),t.CodeNum=0;case 11:case"end":return a.stop()}}),a,null,[[1,8]])})))()},Timing:function(e){var t=this;0===this.CodeNum?(this.disabledBtn=!1,this.getCodeNum="获取验证码",this.CodeNum=60):(this.disabledBtn=!0,this.getCodeNum="已发送(".concat(this.CodeNum,"s)"),this.CodeNum--,setTimeout((function(){t.Timing(e)}),1e3))},clickPhoneQue:function(){"1"==this.$Route.query.id&&this.phone(),h(this)},phone:function(){var e=this;return d(n.default.mark((function t(){var a;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,i.vipCard)({Action:"VerifyPhone",Phone:e.fromData.Phone},"WeChatCardOpera");case 3:a=t.sent,a.Success?(e.bindCardList=a.Data.CardList||[],e.fromData.CardNo=e.bindCardList[0].CardNo,"1"==e.Type&&(e.showCard=!0,e.isActive=!0)):e.$toast.fail(a.Message),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$toast.fail(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},clickLeft:function(){this.$Router.push("/pages/home")},radioChange:function(e){this.fromData.CardNo=e.detail.value,this.showCard=!1,this.showCardNo=!0},chooes:function(){this.showCard=!0}}};function h(e){var t=/^1\d{10}$/;return e.fromData.Phone?t.test(e.fromData.Phone)?(e.phoneTip="",!0):(e.phoneTip="手机号码不正确",!1):(e.phoneTip="请输入手机号码",!1)}t.default=f},a4d0:function(e,t,a){"use strict";var n={uniNavBar:function(){return a.e("components/uni-nav-bar/uni-nav-bar").then(a.bind(null,"44c0"))},error:function(){return a.e("components/error/error").then(a.bind(null,"2de2"))}},r=function(){var e=this,t=e.$createElement,a=(e._self._c,e.bindListMe[0].hasOwnProperty("isShow")),n=e.bindListMe[1].hasOwnProperty("isShow"),r=e.bindListMe[2].hasOwnProperty("isShow");e._isMounted||(e.e0=function(t){e.usernameTip=e.fromData.Username?"":"请输入名字"},e.e1=function(t){e.dayTip=e.fromData.Birthday?"":"请选择生日"},e.e2=function(t){e.sexTip=e.fromData.Sex?"":"请选择性别"},e.e3=function(t){e.Password=e.fromData.Password?"":"请填写密码"},e.e4=function(t){e.CodeTip=e.fromData.Code?"":"请填写验证码"}),e.$mp.data=Object.assign({},{$root:{g0:a,g1:n,g2:r}})},i=[];a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}))},bc6a:function(e,t,a){},c4ba:function(e,t,a){"use strict";a.r(t);var n=a("a4d0"),r=a("cc84");for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("446c");var s,o=a("f0c5"),u=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=u.exports},cc84:function(e,t,a){"use strict";a.r(t);var n=a("5921"),r=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},f772:function(e,t,a){"use strict";(function(e){a("d977");n(a("66fd"));var t=n(a("c4ba"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("c11b")["createPage"])}},[["f772","common/runtime","common/vendor"]]]);