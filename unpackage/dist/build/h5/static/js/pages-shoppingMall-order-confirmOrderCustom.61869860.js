(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shoppingMall-order-confirmOrderCustom"],{3538:function(e,t,r){"use strict";r.r(t);var a=r("c67b"),i=r.n(a);for(var o in a)"default"!==o&&function(e){r.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},8657:function(e,t,r){"use strict";var a={uniNavBar:r("cf1e").default,aNodeData:r("4439").default,uniIcons:r("ee6c").default,aGoodLineBox:r("227a").default,aBottomSubmit:r("7498").default,uniPopup:r("40bf").default,aReceiveAddress:r("423c").default},i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"confirm-order-style",class:e.mainStyle},[r("uni-nav-bar",{attrs:{fixed:!0,"left-icon":"back",title:"确认订单","status-bar":!0,shadow:!1},on:{clickLeft:function(t){arguments[0]=t=e.$handleEvent(t),e.clickLeft.apply(void 0,arguments)}}}),e.loading||0!==e.prodList.length?e._e():r("a-nodeData",{attrs:{stringVal:"获取数据失败"}}),e.prodList.length>0?r("div",[e.$Route.query.isIntegral?e._e():r("div",{staticClass:"indexTop colorStyle"},[e.currentDeliveryType.indexOf("2")>-1||e.currentDeliveryType.indexOf("3")>-1?r("div",{class:["changeMode","changeModeLeft",2===e.radioModes?"borderColor":""],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeMode(2)}}},[2===e.radioModes?r("span",{staticClass:"iconfont icon-xuanzhong changeTopIcon"}):e._e(),r("v-uni-image",{staticClass:"changeModeImg",attrs:{src:"/static/assets/img/Pack.png"}}),r("span",[e._v(e._s(e.currentDeliveryType.indexOf("2")>-1?"外卖配送":"物流配送"))])],1):e._e(),e.currentDeliveryType.indexOf("1")>-1?r("div",{class:["changeMode","changeModeRight",1===e.radioModes?"borderColor":""],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeMode(1)}}},[1===e.radioModes?r("span",{staticClass:"iconfont icon-xuanzhong changeTopIcon"}):e._e(),r("v-uni-image",{staticClass:"changeModeImg",attrs:{src:"/static/assets/img/Eat.png"}}),e._v("到店自取")],1):e._e()]),e.$Route.query.isIntegral?e._e():r("div",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.radioChange.apply(void 0,arguments)}}},[r("div",{staticClass:"order-area"},[r("div",{staticClass:"order-area-icon"},[r("v-uni-image",{attrs:{src:"/static/assets/img/weizhi.png",alt:!0}})],1),e.currentArea&&"{}"!==JSON.stringify(e.currentArea)?r("div",{staticStyle:{flex:"1"}},[r("div",[r("span",[e._v(e._s(e.currentArea.Name)+e._s(e._f("setSex")(e.currentArea.Sex)))]),r("span",{staticClass:"order-area-phone"},[e._v(e._s(e.currentArea.Mobile?e.currentArea.Mobile:e.currentArea.Tel))])]),r("div",{staticClass:"order-area-location"},[e._v(e._s(e.currentArea.Address)+" "+e._s(e.currentArea.House))])]):r("div",{staticStyle:{flex:"1",margin:"auto","font-size":"14px",color:"#909090"}},[e._v("选择"+e._s(2===e.radioModes?"收货":"取货")+"地址")]),r("div",{staticStyle:{margin:"auto 8px",color:"#909090"}},[r("uni-icons",{attrs:{type:"arrowright"}})],1)])]),r("div",{staticClass:"good_card_box"},e._l(e.prodList,(function(t,a){return r("div",{key:a,staticStyle:{"margin-bottom":"10px"}},[r("a-good-lineBox",{attrs:{itemData:t,isOrder:!0,isIntegral:!!e.$Route.query.isIntegral}})],1)})),0),e.$Route.query.isIntegral?r("adCell",{attrs:{text:"门店自取",showArrow:"false"}}):e._e(),!e.prodList[0].DeliveryType||e.prodList[0].DeliveryType.indexOf("3")>-1&&2===e.radioModes?e._e():r("adCell",{attrs:{text:1===e.radioModes?"选择自取时间":"选择收货时间",showArrow:"false"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.clickDataTime.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"customView"},[e._v(e._s(e.UserTime))])],1),e.DiscountList.length>0?r("adCell",{attrs:{text:e.UserDiscountName},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.clickUserDiscount.apply(void 0,arguments)}}},[r("v-uni-view",[e._v(e._s(e.UserDiscount))])],1):e._e(),1===e.radioModes?r("div",{staticClass:"setADcell"},[r("adCell",{attrs:{text:"手机号码",showArrow:"false"}},[r("v-uni-input",{attrs:{type:"text",placeholder:"请输入手机号码"},model:{value:e.phone_user,callback:function(t){e.phone_user=t},expression:"phone_user"}})],1)],1):e._e(),1===e.radioModes?r("div",{staticClass:"setADcell"},[r("adCell",{attrs:{text:"收件名字",showArrow:"false"}},[r("v-uni-input",{attrs:{type:"text",placeholder:"请输入收件名字"},model:{value:e.name_user,callback:function(t){e.name_user=t},expression:"name_user"}})],1)],1):e._e(),r("div",{staticClass:"setADcell"},[r("adCell",{attrs:{text:"备注留言",showArrow:"false",showBottomLine:"false"}},[r("v-uni-input",{attrs:{type:"text",placeholder:"请输入留言"},model:{value:e.UserRemarks,callback:function(t){e.UserRemarks=t},expression:"UserRemarks"}})],1)],1),r("adCell",{attrs:{text:"商品总价格",showArrow:"false",showBottomLine:"false"}},[r("span",[e._v("¥"+e._s(e.ProdTotal))])]),2===e.radioModes?r("adCell",{attrs:{text:"运费",showArrow:"false",showBottomLine:"false"}},[r("span",[e._v(e._s("0"==e.freight?"免运费":"¥"+e.freight))])]):e._e(),r("div",{staticClass:"total-style"},[r("span",[e._v("小计："),r("span",{staticClass:"total-style__color"},[e.allData.ScoreTotal?r("span",[e._v(e._s(e._f("spliceNum")(e.allData.ScoreTotal))+"积分")]):e._e(),e.totalCurrent>0?r("span",[e._v(e._s(e.totalCurrent>0&&e.allData.ScoreTotal?"+":"")+"¥"+e._s(e._f("spliceNum")(e.totalCurrent)))]):e._e()])])]),r("div",{staticClass:"radio-group-play"},[e.$Route.query.isIntegral&&e.allData.CardInfo?r("div",{staticStyle:{"padding-bottom":"4px"}},[e._v("当前卡积分："+e._s(e.allData.CardInfo.Score))]):e._e(),r("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioPayChange.apply(void 0,arguments)}}},[e.allData.SalePriceTotal&&e.$Route.query.isIntegral||!e.$Route.query.isIntegral?r("div",[e.allData.hasOwnProperty("CardInfo")?r("div",{staticClass:"radio-group-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.PayTypeClick("1")}}},[r("div",[r("img",{staticClass:"wechat",attrs:{slot:"right-icon",src:"/static/assets/img/moneyPay.png"},slot:"right-icon"}),r("span",{staticClass:"custom-title"},[e._v("卡支付（余额:"+e._s(e.CardInfo.Balance)+"）")])]),r("div",{staticStyle:{flex:"1","text-align":"right"}},[Number(e.CardInfo.Balance)>e.totalCurrent?r("v-uni-radio",{attrs:{slot:"right-icon",value:"1",checked:"1"==e.radioPayType},slot:"right-icon"}):r("span",{staticClass:"summaryNum",staticStyle:{color:"#777"}},[e._v("余额不足")])],1)]):e._e(),e.$Route.query.isIntegral&&!e.allData.CardInfo?e._e():r("div",{staticClass:"radio-group-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.PayTypeClick("2")}}},[r("div",[r("img",{staticClass:"wechat",attrs:{src:"/static/assets/img/weixinPay.png"}}),r("span",{staticClass:"custom-title"},[e._v("微信支付")])]),r("v-uni-radio",{staticStyle:{flex:"1","text-align":"right"},attrs:{slot:"right-icon",value:"2",checked:"2"==e.radioPayType},slot:"right-icon"})],1)]):e._e()])],1),r("a-bottomSubmit",{attrs:{isOrder:!0,allMoney:e.totalCurrent,scoreTatal:e.totalCurrentScore,cardInfo:e.allData.CardInfo,isIntegral:e.$Route.query.isIntegral},on:{submitMoney:function(t){arguments[0]=t=e.$handleEvent(t),e.submitMoney.apply(void 0,arguments)}}})],1):e._e(),r("div",{staticClass:"changeAreaStyle"},[r("uni-popup",{ref:"showAreaList",attrs:{type:"bottom"},model:{value:e.showAreaList,callback:function(t){e.showAreaList=t},expression:"showAreaList"}},[r("div",{staticClass:"confirm-order-popup"},[r("div",{staticClass:"top"},[r("span",{staticClass:"cancel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.showAreaList.close()}}},[e._v("取消")]),r("span",[e._v("选择地址")])]),r("v-uni-radio-group",{ref:"checkboxAreaRef",staticClass:"bottom-area",on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.changeGroup.apply(void 0,arguments)}}},e._l(e.areaList,(function(t,a){return r("div",{key:a,staticClass:"bottom-area__box",on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.changeArea(t,a)}}},[r("v-uni-radio",{staticClass:"checkbox-my",attrs:{value:t.SID,checked:e.showAreaList==t.SID}}),r("div",{staticClass:"bottom-area__info"},[r("div",[e._v(e._s(t.Address)+" "+e._s(t.House))]),r("div",{staticClass:"bottom-area__phone"},[e._v(e._s(t.Name)),t.Sex?r("span",[e._v(e._s(e._f("setSex")(t.Sex)))]):e._e(),e._v(""),r("span",[e._v(e._s(t.Mobile?t.Mobile:t.Tel))])])]),2===e.radioModes?r("span",{staticClass:"icon iconfont icon-bianji bottom-area__icon",on:{click:function(r){r.stopPropagation(),arguments[0]=r=e.$handleEvent(r),e.clickEdit(t)}}}):e._e()],1)})),0),2===e.radioModes?r("div",{staticClass:"bottom-area__add",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.areaSet.apply(void 0,arguments)}}},[r("uni-icons",{staticClass:"colorStyle",staticStyle:{"vertical-align":"middle","font-size":"18px","margin-right":"6px"},attrs:{type:"plus"}}),r("span",{staticStyle:{"vertical-align":"middle"}},[e._v("新增收货地址")])],1):e._e()],1)])],1),r("uni-popup",{ref:"addEditArea",staticClass:"confirm-area-popup",attrs:{position:"bottom"},model:{value:e.addEditArea,callback:function(t){e.addEditArea=t},expression:"addEditArea"}},[e.addEditArea?r("a-receive-address",{attrs:{radioModes:e.radioModes,areaInfo:e.areaInfo,currentDeliveryType:e.currentDeliveryType},on:{clickGo:function(t){arguments[0]=t=e.$handleEvent(t),e.clickGo.apply(void 0,arguments)},saveArea:function(t){arguments[0]=t=e.$handleEvent(t),e.saveAreaSet.apply(void 0,arguments)}}}):e._e()],1),r("uni-popup",{ref:"selectTime",staticStyle:{"max-height":"50%"},attrs:{type:"bottom"},model:{value:e.selectTime,callback:function(t){e.selectTime=t},expression:"selectTime"}},[r("div",{staticClass:"confirm-selectTime-popup"},[r("div",{staticClass:"leftNavsidebar"},[r("v-uni-view",{class:["homepageLeftFixed"],staticStyle:{width:"130px"}},e._l(e.sidebarList,(function(t,a){return r("v-uni-view",{key:a,class:["homepageLeft",a===e.currentIndex?"activeCanteen":""],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeSider(a)}}},[e._v(e._s(t))])})),1)],1)]),e.rightTimeList.length>0?r("div",{staticClass:"rightTime"},[r("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioTimeFun.apply(void 0,arguments)}}},e._l(e.rightTimeList,(function(t,a){return r("div",{key:a,attrs:{border:!1}},[r("ad-cell",{attrs:{text:t,showArrow:"false",showBottomLine:"false"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.rightTimeClick(t)}}},[r("v-uni-radio",{attrs:{value:t,checked:e.radioTime==t}})],1)],1)})),0)],1):e._e()]),r("uni-popup",{ref:"discountProgram",attrs:{type:"bottom"}},[r("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.setDiscountClick.apply(void 0,arguments)}}},[r("ad-cell",{attrs:{text:"暂不使用",showArrow:"false"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.DiscountClick("undefined")}}},[r("v-uni-radio",{staticStyle:{display:"inline-block","vertical-align":"middle","margin-left":"20px"},attrs:{value:"undefined",checked:"undefined"===e.radioDiscount}})],1),e._l(e.DiscountList,(function(t,a){return r("div",{key:a},[r("adCell",{attrs:{text:t.PrefName,showArrow:"false",showBottomLine:"false"},on:{click:function(r){arguments[0]=r=e.$handleEvent(r),e.DiscountClick(t)}}},[r("span",{staticStyle:{"margin-right":"20px"}},[e._v("-¥"+e._s(t.DiscPrice||0))]),r("v-uni-radio",{attrs:{value:t.PrefNo,checked:t.PrefNo===e.radioDiscount}})],1)],1)}))],2)],1)],1)},o=[];r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a}))},"91a3":function(e,t,r){"use strict";r.r(t);var a=r("8657"),i=r("3538");for(var o in i)"default"!==o&&function(e){r.d(t,e,(function(){return i[e]}))}(o);r("cda8");var n,s=r("f0c5"),c=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"66674604",null,!1,a["a"],n);t["default"]=c.exports},a3ca:function(e,t,r){var a=r("24fb");t=a(!1),t.push([e.i,".indexTop[data-v-66674604]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:10px 0 5px 0;background:#fff}.changeMode[data-v-66674604]{width:140px;height:50px;display:-webkit-box;display:-webkit-flex;display:flex;background:#eee;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;border-radius:10px;font-size:14px;position:relative;overflow:hidden}.changeModeImg[data-v-66674604]{width:25px!important;height:25px!important}.changeModeLeft[data-v-66674604]{margin-right:15px}.changeModeRight[data-v-66674604]{margin-left:15px}.changeTopIcon[data-v-66674604]{right:-2px;position:absolute;bottom:-4px;font-size:28px}.confirm-order-style[data-v-66674604]{margin-bottom:80px\n  /*margin-left: 10px !important;*/}.confirm-order-style .uni-popup[data-v-66674604]{z-index:999}.confirm-order-style .setADcell[data-v-66674604] .detailView1{-webkit-box-flex:0;-webkit-flex:none;flex:none}.confirm-order-style .setADcell[data-v-66674604] .headView{-webkit-box-flex:0;-webkit-flex:none;flex:none;width:90px}.confirm-order-style .radio-group-play[data-v-66674604]{background-color:#fff;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:%?26?% %?24?%}.confirm-order-style .radio-group-play .radio-group-item[data-v-66674604]{padding:6px 0;display:-webkit-box;display:-webkit-flex;display:flex}.confirm-order-style .radio-group-play .custom-title[data-v-66674604]{vertical-align:middle}.confirm-order-style .total-style[data-v-66674604]{background:#fff;text-align:right;line-height:40px;font-size:16px;padding-right:10px;border-bottom:%?1?% solid #ebedf0}.confirm-order-style .total-style__color[data-v-66674604]{color:red}.confirm-order-style .order-area[data-v-66674604]{background:#fff;padding:14px 6px;display:-webkit-box;display:-webkit-flex;display:flex}.confirm-order-style .order-area-icon[data-v-66674604]{margin:auto}.confirm-order-style .order-area-icon img[data-v-66674604],\n.confirm-order-style .order-area-icon uni-image[data-v-66674604]{margin:0 10px;width:40px;height:40px}.confirm-order-style .order-area-phone[data-v-66674604]{font-size:14px;color:#909090;margin-left:8px}.confirm-order-style .order-area-location[data-v-66674604]{font-size:12px;margin-top:3px}.confirm-order-style .good_card_box[data-v-66674604]{background:#fff;margin:5px 0 5px;padding:10px}.confirm-order-style .good_card_box .boxShadow[data-v-66674604]{box-shadow:none}.confirm-order-style .good_card_box .rightBox[data-v-66674604]{margin:0 10px}.confirm-order-style .confirm-order-popup[data-v-66674604]{background-color:#fff;max-height:50%}.confirm-order-style .confirm-order-popup .top[data-v-66674604]{padding:10px 20px 10px;text-align:center;border-bottom:1px solid #eee;position:relative}.confirm-order-style .confirm-order-popup .cancel[data-v-66674604]{font-size:12px;position:absolute;left:20px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);color:#777}.confirm-order-style .bottom-area[data-v-66674604]{max-height:60vh;overflow:scroll}.confirm-order-style .bottom-area__box[data-v-66674604]{display:-webkit-box;display:-webkit-flex;display:flex;padding:8px 12px;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.confirm-order-style .bottom-area__info[data-v-66674604]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:14px}.confirm-order-style .bottom-area__icon[data-v-66674604]{width:30px;text-align:center;margin:auto}.confirm-order-style .bottom-area__phone[data-v-66674604]{color:#969799;font-size:12px;margin-top:5px}.confirm-order-style .bottom-area__add[data-v-66674604]{text-align:center;padding:10px;border-top:1px solid #eee}.confirm-order-style .bottom-area .checkbox-my[data-v-66674604]{margin-right:10px}.confirm-order-style .confirm-area-popup[data-v-66674604]{height:100%}.confirm-order-style .confirm-area-popup[data-v-66674604] .uni-popup__wrapper-box{height:100%;background:#fff}.confirm-order-style .confirm-selectTime-popup .leftNavsidebar[data-v-66674604]{width:130px;display:fixed;position:fixed;top:0;overflow-y:scroll;background:#f8f8f8;height:100vh}.confirm-order-style .confirm-selectTime-popup .leftNavsidebar .activeCanteen[data-v-66674604]{background:#fff}.confirm-order-style .confirm-selectTime-popup .leftNavsidebar .homepageLeft[data-v-66674604]{line-height:60px;padding-left:6px}.confirm-order-style .rightTime[data-v-66674604]{height:50vh;padding:8px;box-sizing:border-box;margin-left:130px;background:#fff;overflow-y:scroll}.confirm-order-style .wechat[data-v-66674604]{width:18px;height:18px;margin-right:8px;display:inline-block;font-size:18px;vertical-align:middle}.confirm-order-style .wechat uni-image[data-v-66674604]{width:100%;height:100%}",""]),e.exports=t},c67b:function(e,t,r){"use strict";var a=r("ee27");r("4de4"),r("4160"),r("c975"),r("a15b"),r("a434"),r("a9e3"),r("b680"),r("d3b7"),r("acd8"),r("e25e"),r("ac1f"),r("3ca3"),r("1276"),r("159b"),r("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("96cf");var i=a(r("c964")),o=r("819e"),n=r("fcf5"),s=a(r("f8d1")),c=a(r("a21e")),d={name:"confirmOrder",mixins:[s.default],components:{adCell:c.default},data:function(){return{mainStyle:getApp().globalData.mainStyle,mainColor:getApp().globalData.mainColor,loading:!0,currentItem:[],UserRemarks:"",UserTime:"",UserDiscount:"",UserDiscountName:"请选择方案",currentArea:{},radioModes:2,prodList:[],showAreaList:!1,addEditArea:!1,selectTime:!1,discountProgram:!1,resultArea:"",areaList:[],DeliveryAreaList:[],takeOver:[],freight:0,total:0,totalCurrent:0,location:{},activeKey:0,sidebarList:[],rightTimeList:[],radioTime:"",radioPayType:"1",CardInfo:{},phone_user:"",name_user:"",orderId:"",cardSids:[],ProdTotal:0,radioDiscount:"",DiscountList:[],allTimeSlot:[],RecordTime:{},areaInfo:{},currentDeliveryType:"",testData:{},allData:{},totalCurrentScore:0,currentIndex:0}},created:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.state.currentCard&&0!==e.$store.state.currentCard.length||(e.$Router.back(2),e.$Router.back(100)),t.next=3,e.getWxConfig();case 3:if(r=e.$store.state.currentCard||[],r.forEach((function(t){if(t.SID&&e.cardSids.push(t.SID),t.PartsNo instanceof Array){var r=[],a=JSON.parse(JSON.stringify(t.PartsNo));a.forEach((function(e){r.push(e.ProdNo)})),t.PartsNo=r.join(",")}})),e.currentItem=JSON.stringify(r),e.cardSids=e.cardSids?e.cardSids.join(","):"",!e.$Route.query.isIntegral){t.next=12;break}return t.next=10,e.getInfoIntegral();case 10:t.next=14;break;case 12:return t.next=14,e.getInfo();case 14:case"end":return t.stop()}}),t)})))()},methods:{getInfo:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loading=!0,uni.showLoading();try{r=JSON.parse(e.currentItem),e.currentDeliveryType=r[0].DeliveryType,a={Action:"SettlePay",ProdList:e.currentItem,DefLongitude:e.location.longitude,DefLatitude:e.location.latitude,DeliveryType:e.currentDeliveryType},r[0].hasOwnProperty("PromotionItemSID")&&(a.PromotionItemSID=r[0].PromotionItemSID),Promise.all([e.saveArea(!0),(0,o.vipCard)(a,"UProdOpera")]).then((function(t){e.areaList=t[0],e.takeOver=t[0];var r=t[1].Data;e.allData=r,e.prodList=r.ProdList,e.currentItem=JSON.parse(JSON.stringify(e.prodList)),e.currentDeliveryType=r.ProdList[0].DeliveryType,e.currentItem.forEach((function(e){"string"!==typeof e.PartsNo&&(e.PartsNo.forEach((function(t,r){e.arr=[],e.arr.push(t.ProdNo)})),e.PartsNo=e.arr?e.arr.join(","):"",delete e.arr),e.PartsList&&(e.PartsList=JSON.stringify(e.PartsList))})),e.currentItem=JSON.stringify(e.currentItem);var a=0;e.prodList.length>0&&e.prodList.forEach((function(e,t){e.DeliveryType&&""!==e.DeliveryType&&(e.DeliveryType=e.DeliveryType.split(",")),e.FinHour>a&&(a=e.FinHour)})),e.freight=r.Freight,e.DiscountList=r.DiscList||[],e.DiscountList.length>0&&(e.radioDiscount=e.DiscountList[0].PrefNo,e.UserDiscount="¥"+(e.DiscountList[0].DiscPrice||0),e.UserDiscountName=e.DiscountList[0].PrefName),e.total=r.SumTotal,e.ProdTotal=r.ProdTotal,e.totalCurrent=parseFloat(Number(r.SumTotal).toFixed(2)),e.CardInfo=r.hasOwnProperty("CardInfo")?r.CardInfo:{},"{}"!==JSON.stringify(e.CardInfo)?Number(r.CardInfo.Balance)<Number(r.SumTotal)&&(e.radioPayType="2"):e.radioPayType="2",e.DeliveryAreaList=r.ShopInfoList;var i=e.areaList.filter((function(e){return"1"===e.Defaults}))[0];e.currentArea=i||{},e.resultArea=i?i.SID:"";var o=Number(r.ShopBase.ScopeDay),s=0,c=0;if(Number(a)/24>=1)s=Number(a)/24,c=0;else{var d=p(r.ShopBase.EndTime),f=p((0,n.getTime)(!1,!1,!0)),m=60*Number(a)*60;(m+f).toFixed(2)>d?(c=Number(a),s+=1):(c=Number(a),s=0)}e.sidebarList=l(o,s);var h=u(r.ShopBase,c,s),v=h.arr,g=h.arrToday;e.allTimeSlot=v,e.todayTimeSlot=g,e.rightTimeList=g,e.radioTime=g[0],e.RecordTime={radioTime:g[0],index:0},e.UserTime=e.sidebarList[e.activeKey]+" "+e.radioTime,e.loading=!1,uni.hideLoading()})).catch((function(t){e.loading=!1,uni.hideLoading()}))}catch(i){e.loading=!1,uni.hideLoading()}case 3:case"end":return t.stop()}}),t)})))()},getInfoIntegral:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,uni.showLoading(),t.next=4,(0,o.vipCard)({Action:"SettlePay",ProdList:e.currentItem},"UIntegralOpera");case 4:r=t.sent,a=r.Data,e.prodList=a.ProdList,e.allData=a,e.CardInfo=a.CardInfo,e.currentItem=JSON.parse(JSON.stringify(e.prodList)),e.totalCurrent=parseFloat(Number(a.SalePriceTotal).toFixed(2)),a.ScoreTotal&&(e.totalCurrentScore=parseFloat(Number(a.ScoreTotal).toFixed(2))||0),e.loading=!1,uni.hideLoading(),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),e.loading=!1,uni.hideLoading();case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()},orderArea:function(){},changeMode:function(e){this.radioModes=e,this.areaList=1==e?this.DeliveryAreaList:this.takeOver,this.currentArea={},1===e?this.totalCurrent=this.total-this.freight:(this.totalCurrent=this.total,this.takeOver.filter((function(e){return"1"===e.Defaults})).length>0&&(this.currentArea=this.takeOver.filter((function(e){return"1"===e.Defaults}))[0]),this.resultArea=this.currentArea.SID),this.totalCurrent=parseFloat(Number(this.totalCurrent).toFixed(2))},radioChange:function(){this.showAreaList=!0,this.$refs.showAreaList.open()},radioPayChange:function(e){this.CardInfo&&Number(this.CardInfo.Balance)<this.totalCurrent||(this.radioPayType=e.detail.value)},changeGroup:function(e){this.resultArea=e.detail.value},changeArea:function(e,t){var r=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var i,n,s,c,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r.showAreaList=e.SID,1===r.radioModes?i="IsPickShop":r.currentDeliveryType.indexOf("2")>-1?i="CalcFreight":r.currentDeliveryType.indexOf("3")>-1&&(i="CalcLogistics"),a.prev=2,r.loading=!0,uni.showLoading(),n=JSON.parse(r.currentItem),s={Action:i,ProdList:r.currentItem,Latitude:e.Latitude||"",Longitude:e.Longitude||"",Province:e.Province||"",PayType:r.radioPayType,PrefNo:"undefined"===r.radioDiscount?"":r.radioDiscount,ShopSID:e.SID},n[0].hasOwnProperty("PromotionItemSID")&&(s.PromotionItemSID=n[0].PromotionItemSID),a.next=10,(0,o.vipCard)(s,"UProdOpera");case 10:c=a.sent,d=c.Data,r.currentArea=e,r.showAreaList=!1,r.$refs.showAreaList.close(),r.resultArea=e.SID,r.areaList.splice(t,1),r.areaList.unshift(e),r.freight=d.Freight,r.totalCurrent=parseFloat(Number(d.SumTotal).toFixed(2)),r.loading=!1,uni.hideLoading(),a.next=28;break;case 24:a.prev=24,a.t0=a["catch"](2),r.loading=!1,uni.hideLoading();case 28:case"end":return a.stop()}}),a,null,[[2,24]])})))()},clickEdit:function(e){this.areaInfo=e,this.$refs.addEditArea.open(),this.addEditArea=!0},clickGo:function(){this.$refs.addEditArea.close(),this.addEditArea=!1},clickLeft:function(){this.$Router.push(this.$store.state.historyUrl)},clickDataTime:function(){this.selectTime=!0,this.$refs.selectTime.open()},clickUserDiscount:function(){this.discountProgram=!0,this.$refs.discountProgram.open()},clickTime:function(){},saveAreaSet:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$refs.addEditArea.close(),e.addEditArea=!1,e.loading=!0,uni.showLoading(),t.next=6,e.saveArea(!1);case 6:r=t.sent,e.areaList=r,e.takeOver=r,e.loading=!1,uni.hideLoading();case 11:case"end":return t.stop()}}),t)})))()},saveArea:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function r(){var a,i,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.currentDeliveryType.indexOf("2")>-1?a=1:t.currentDeliveryType.indexOf("3")>-1&&(a=2),r.next=4,(0,o.vipCard)({Action:"GetAddressList",Type:a},"UMemberOpera");case 4:return i=r.sent,n=i.Data,e&&uni.showLoading(),r.abrupt("return",n.AddressList);case 10:return r.prev=10,r.t0=r["catch"](0),r.abrupt("return",[]);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},PayTypeClick:function(e){this.CardInfo&&Number(this.CardInfo.Balance)<this.totalCurrent||(this.radioPayType=e)},changeSider:function(e){this.currentIndex=e,this.activeKey=e,this.RecordTime.index===e?this.radioTime=this.RecordTime.radioTime:this.radioTime="",this.rightTimeList=0!==e?this.allTimeSlot:this.todayTimeSlot},rightTimeClick:function(e){this.RecordTime={radioTime:e,index:this.activeKey},this.radioTime=e,this.selectTime=!1,this.$refs.selectTime.close(),this.UserTime=this.sidebarList[this.activeKey]+" "+this.radioTime},radioTimeFun:function(e){this.radioTime=e.detail.value},setDiscountClick:function(e){this.radioDiscount=e.detail.value},DiscountClick:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function r(){var a,i,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.PrefNo,"undefined"===e&&(a=""),t.discountProgram=!1,t.$refs.discountProgram.close(),r.prev=4,i={Action:"SelectDisc",PrefNo:a,ProdList:t.currentItem,PayType:t.radioPayType,Latitude:t.currentArea.Latitude,Longitude:t.currentArea.Longitude},t.loading=!0,uni.showLoading(),r.next=10,(0,o.vipCard)(i,"UProdOpera");case 10:n=r.sent,s=n.Data,t.UserDiscountName="undefined"===e?"优惠券方案":e.PrefName,t.UserDiscount="undefined"===e?"暂不使用":"¥"+e.DiscPrice,t.radioDiscount="undefined"===e?e:e.PrefNo,t.totalCurrent=parseFloat(Number(s.Total?s.Total:s.SumTotal).toFixed(2)),t.loading=!1,uni.hideLoading(),r.next=24;break;case 20:r.prev=20,r.t0=r["catch"](4),t.loading=!1,uni.hideLoading();case 24:case"end":return r.stop()}}),r,null,[[4,20]])})))()},areaSet:function(){this.areaInfo={},this.addEditArea=!0,this.$refs.addEditArea.open()},submitMoney:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var r,a,i,s,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("{}"!==JSON.stringify(e.currentArea)||e.$Route.query.isIntegral){t.next=3;break}return e.$toast("请选择地址"),t.abrupt("return");case 3:if(1!==e.radioModes){t.next=15;break}if(e.phone_user&&""!==e.phone_user){t.next=9;break}return e.$toast("请填写手机号码"),t.abrupt("return");case 9:if((0,n.checkMobile)(e.phone_user)){t.next=12;break}return e.$toast("手机号格式错误"),t.abrupt("return");case 12:if(e.name_user&&""!==e.name_user){t.next=15;break}return e.$toast("请填写收件名字"),t.abrupt("return");case 15:if("undefined"===e.radioDiscount&&(e.radioDiscount=""),r=e.radioModes,2===e.radioModes?e.currentDeliveryType.indexOf("2")>-1?r=2:e.currentDeliveryType.indexOf("3")>-1&&(r=3):r=1,"string"!==typeof e.currentItem&&(e.currentItem=JSON.stringify(e.currentItem)),a={Action:"OrderPay",DeliveryType:r,UserName:2===e.radioModes?e.currentArea.Name:e.name_user,Mobile:1===e.radioModes?e.phone_user:e.currentArea.Mobile,Address:2===e.radioModes?e.currentArea.Address+"  "+e.currentArea.House:"",ProdList:e.currentItem,Latitude:e.currentArea.Latitude||"",Longitude:e.currentArea.Longitude||"",Province:e.currentArea.Province||"",AddressSID:2===e.radioModes?e.resultArea.SID:"",ShopSID:1===e.radioModes?e.resultArea:"",UserRemarks:e.UserRemarks,PayType:e.radioPayType,PickDate:e.sidebarList[e.RecordTime.index],PickTime:e.RecordTime.radioTime,CartSID:e.cardSids,PrefNo:e.radioDiscount},JSON.parse(e.currentItem)[0].hasOwnProperty("PromotionItemSID")&&(a.PromotionItemSID=JSON.parse(e.currentItem)[0].PromotionItemSID),!e.$Route.query.isIntegral){t.next=31;break}if(i=JSON.parse(e.currentItem),a=i[0],a.Action="OrderPay",a.PayType=e.radioPayType,a.UserRemarks=e.UserRemarks,a.DeliveryType=1,e.CardInfo){t.next=31;break}return e.$toast.fail("未绑定微卡"),t.abrupt("return");case 31:return s=e.$Route.query.isIntegral?"UIntOrderOpera":"UOrderOpera",e.loading=!0,uni.showLoading(),t.prev=34,t.next=37,(0,o.vipCard)(a,s);case 37:if(c=t.sent,d=c.Data,e.loading=!1,uni.hideLoading(),e.$store.commit("SET_CURRENT_CARD",[]),uni.removeStorageSync("alreadyPaid"),"1"===e.radioPayType)console.log(d,"---"),e.$Router.push({path:"/pages/shoppingMall/order/confirmCard",query:{Balance:e.CardInfo.Balance,Score:e.CardInfo.Score,PayScore:d.hasOwnProperty("PayScore")?d.PayScore:"",total:d.SumTotal,PayNo:d.PayNo,IsPass:d.IsPass,OrderType:d.OrderType}});else{e.testData=d;try{(0,n.weChatPayment)(e,d,!1)}catch(l){that.$toast.fail("微信调起失败"),e.loading=!1,uni.hideLoading()}}t.next=50;break;case 46:t.prev=46,t.t0=t["catch"](34),e.loading=!1,uni.hideLoading();case 50:case"end":return t.stop()}}),t,null,[[34,46]])})))()}}};function l(e,t){var r=[],a="";e=Number(e);for(var i=0;i<e;i++){var o=864e5,s=t>1?(new Date).getTime()+t*o:(new Date).getTime();a=i*o+s,r.push((0,n.getTime)(a,!0))}return r}function u(e,t,r){var a=3600,i=60*Number(e.IntervalMinute),o=p(e.EndTime),s=Number(p(e.StartTime)),c=[],d=[];while(s<=o)c.push(f(s)),s+=i;return 0==r?c.forEach((function(e){e=p(e),0==r&&e>p((0,n.getTime)(!1,!1,!0))+Number(t)*a&&d.push(f(e))})):d=c,{arr:c,arrToday:d}}function p(e){var t=0,r=e.split(":")[0],a=e.split(":")[1],i=e.split(":")[2];return t=Number(3600*r)+Number(60*a)+Number(i),t}function f(e){var t=parseInt(e),r=0,a=0,i="";return t>60&&(r=parseInt(t/60),t=parseInt(t%60),r>60&&(a=parseInt(r/60),r=parseInt(r%60))),a=a<10?"0"+a:a,r=r<10?"0"+r:r,t=t<10?"0"+t:t,i=a+":"+r+":"+t,i}t.default=d},cda8:function(e,t,r){"use strict";var a=r("fce0"),i=r.n(a);i.a},f8d1:function(e,t,r){"use strict";var a=r("ee27");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("96cf");var i=a(r("c964")),o=(r("819e"),{data:function(){return{location:{},publicName:"",publicMobile:""}},methods:{getWxConfig:function(){return(0,i.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})))()}}});t.default=o},fce0:function(e,t,r){var a=r("a3ca");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=r("4f06").default;i("303fe531",a,!0,{sourceMap:!1,shadowMode:!1})}}]);